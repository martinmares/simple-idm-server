# Server Configuration
SERVER_HOST=127.0.0.1
SERVER_PORT=8080

# Database Configuration
DATABASE_URL=postgres://postgres:postgres@localhost/simple_idm

# JWT Configuration
JWT_ISSUER=http://localhost:8080
ACCESS_TOKEN_EXPIRY_SECONDS=3600
REFRESH_TOKEN_EXPIRY_SECONDS=2592000
REFRESH_TOKEN_CLEANUP_INTERVAL_SECONDS=0 # 0 = cleanup only on token requests
AUTH_SESSION_EXPIRY_SECONDS=3600 # SSO session duration (1 hour)
PASSWORD_RESET_TOKEN_EXPIRY_SECONDS=3600
PASSWORD_RESET_CLEANUP_INTERVAL_SECONDS=0
PASSWORD_RESET_MAX_PER_HOUR=5
JWT_PRIVATE_KEY_PATH=./keys/private.pem
JWT_PUBLIC_KEY_PATH=./keys/public.pem
JWT_KEY_ID=default-key-2025

# Rate limiting
RATE_LIMIT_REQUESTS_PER_SECOND=5
RATE_LIMIT_BURST_SIZE=10
# Stricter limits for /oauth2/token endpoint
RATE_LIMIT_TOKEN_ENDPOINT_REQUESTS_PER_SECOND=2
RATE_LIMIT_TOKEN_ENDPOINT_BURST_SIZE=5

# Device Flow Configuration
DEVICE_CODE_EXPIRY_SECONDS=600
DEVICE_CODE_POLLING_INTERVAL_SECONDS=5
DEVICE_USER_CODE_LENGTH=8
DEVICE_USER_CODE_FORMAT=XXXX-XXXX
DEVICE_CODE_CLEANUP_INTERVAL_SECONDS=3600
DEVICE_MAX_VERIFICATION_ATTEMPTS=5

# Admin API Configuration
# WARNING: Change this in production! Use strong random token.
# For production, prefer using Admin M2M OAuth2 client instead.
ADMIN_ROOT_TOKEN=dev-admin-token-change-me-in-production

# Logging
RUST_LOG=simple_idm_server=debug,tower_http=debug
